<div class="profile-container">
  <!-- Header -->
  <div class="header">
    <h1 class="title">Profile</h1>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button
      class="tab"
      [class.active]="activeTab === 'account'"
      (click)="activeTab = 'account'"
    >
      Account Details
    </button>
    <button
      class="tab"
      [class.active]="activeTab === 'transactions'"
      (click)="activeTab = 'transactions'"
    >
      Transactions History
    </button>
  </div>

  <!-- ACCOUNT DETAILS SECTION -->
  <div class="content" *ngIf="activeTab === 'account'" [@fadeInOut]>
    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Profile Section with Leaderboard and Image -->
      <div class="profile-header">
        <!-- Leaderboard Section -->
        <div class="leaderboard-section">
          <h3>Leaderboard</h3>
          <div class="leaderboard-list">
            <div
              class="leaderboard-item"
              *ngFor="let user of leaderboardUsers; trackByUserId"
              [class.current-user]="user.userId === currentUserId"
            >
              <div class="rank">{{ user.rank }}</div>
              <div class="user-info">
                <div class="details">
                  <div class="name">
                    {{ user.userId === currentUserId ? "You" : user.name }}
                  </div>
                  <div class="points">{{ user.points }} pts</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Profile Image Section -->
        <div class="profile-image-section">
          <div class="profile-image">
            <img
              [src]="profileImage || '/assets/images/userImage.webp'"
              [alt]="profileData.name || 'Profile Image'"
            />
          </div>
          <label class="upload-btn">
            UPLOAD YOUR IMAGE
            <input
              type="file"
              (change)="onImageUpload($event)"
              accept="image/*"
              hidden
            />
          </label>
        </div>
      </div>

      <!-- Profile Form -->
      <div class="profile-form">
        <div class="form-row">
          <div class="form-group">
            <label for="fullName">Full Name</label>
            <input
              id="fullName"
              type="text"
              [(ngModel)]="profileData.name"
              name="fullName"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="primaryNumber">Primary Number</label>
            <input
              id="primaryNumber"
              type="text"
              [(ngModel)]="profileData.primaryNumber"
              name="primaryNumber"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="email">Email</label>
            <input
              id="email"
              type="email"
              [(ngModel)]="profileData.email"
              name="email"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group half">
            <label for="alternativeNumber">Alternative Number</label>
            <div class="phone-input">
              <select
                [(ngModel)]="profileData.countryCode"
                class="country-code"
                name="countryCode"
              >
                <option value="+880">+880</option>
                <option value="+1">+1</option>
                <option value="+44">+44</option>
              </select>
              <input
                id="alternativeNumber"
                type="text"
                [(ngModel)]="profileData.alternativeNumber"
                placeholder="Alternative Number"
                name="alternativeNumber"
              />
            </div>
          </div>
        </div>

        <button class="update-btn" (click)="onUpdate()" [disabled]="isUpdating">
          {{ isUpdating ? "UPDATING..." : "UPDATE" }}
          <i class="fas fa-chevron-down" *ngIf="!isUpdating"></i>
          <i class="fas fa-spinner fa-spin" *ngIf="isUpdating"></i>
        </button>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <div class="form-group">
        <label for="currentOccupation">Current Occupation</label>
        <select
          id="currentOccupation"
          [(ngModel)]="profileData.currentOccupation"
          name="currentOccupation"
        >
          <option value="">Select Occupation</option>
          <option
            *ngFor="let occupation of occupations; trackBy: trackByValue"
            [value]="occupation"
          >
            {{ occupation }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="skillSector"
          >Which sector do you want to build skills in?</label
        >
        <select
          id="skillSector"
          [(ngModel)]="profileData.skillSector"
          name="skillSector"
        >
          <option value="">Select Skill Sector</option>
          <option
            *ngFor="let sector of skillSectors; trackBy: trackByValue"
            [value]="sector"
          >
            {{ sector }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="specificTopic">Select a specific topic</label>
        <select
          id="specificTopic"
          [(ngModel)]="profileData.specificTopic"
          name="specificTopic"
        >
          <option value="">Select Topic</option>
          <option
            *ngFor="let topic of specificTopics; trackBy: trackByValue"
            [value]="topic"
          >
            {{ topic }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="gender">Gender</label>
        <select id="gender" [(ngModel)]="profileData.gender" name="gender">
          <option value="">Select Gender</option>
          <option
            *ngFor="let gender of genders; trackBy: trackByValue"
            [value]="gender"
          >
            {{ gender }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="age">Age</label>
        <input
          id="age"
          type="number"
          [(ngModel)]="profileData.age"
          name="age"
          min="1"
          max="120"
        />
      </div>

      <div class="form-group">
        <label for="educationalBackground">Educational Background</label>
        <select
          id="educationalBackground"
          [(ngModel)]="profileData.educationalBackground"
          name="educationalBackground"
        >
          <option value="">Select Education Level</option>
          <option
            *ngFor="let education of educationLevels; trackBy: trackByValue"
            [value]="education"
          >
            {{ education }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="subject">Subject</label>
        <select id="subject" [(ngModel)]="profileData.subject" name="subject">
          <option value="">Select Subject</option>
          <option
            *ngFor="let subject of subjects; trackBy: trackByValue"
            [value]="subject"
          >
            {{ subject }}
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Change Password Section -->
  <div
    class="change-password-section"
    *ngIf="activeTab === 'account'"
    [@fadeInOut]
  >
    <h2>Change Password</h2>
    <div class="form-group">
      <label for="oldPassword">Old Password</label>
      <input
        id="oldPassword"
        type="password"
        [(ngModel)]="passwordForm.oldPassword"
        placeholder="Enter old password"
        name="oldPassword"
      />
    </div>
    <div class="form-group">
      <label for="newPassword">New Password</label>
      <input
        id="newPassword"
        type="password"
        [(ngModel)]="passwordForm.newPassword"
        placeholder="Enter new password"
        name="newPassword"
      />
    </div>
    <div class="form-group">
      <label for="confirmPassword">Confirm Password</label>
      <input
        id="confirmPassword"
        type="password"
        [(ngModel)]="passwordForm.confirmPassword"
        placeholder="Confirm new password"
        name="confirmPassword"
      />
    </div>
    <button class="change-password-btn" (click)="onChangePassword()">
      Change Password
    </button>
  </div>

  <!-- Transaction History Section -->
  <div
    class="transaction-history"
    *ngIf="activeTab === 'transactions'"
    [@fadeInOut]
  >
    <h2>Transaction History</h2>

    <div class="transaction-filters">
      <select [(ngModel)]="transactionFilter" name="transactionFilter">
        <option value="">All Types</option>
        <option value="Nagad">Nagad</option>
        <option value="Bkash">Bkash</option>
        <option value="Rocket">Rocket</option>
      </select>
    </div>

    <div class="transactions-table">
      <div class="transaction-row header">
        <div>ID</div>
        <div>Date</div>
        <div>Description</div>
        <div>Type</div>
        <div>Amount</div>
        <div>Status</div>
      </div>

      <div
        class="transaction-row"
        *ngFor="let txn of filteredTransactions; trackBy: trackByTransactionId"
      >
        <div>{{ txn.id }}</div>
        <div>{{ txn.date }}</div>
        <div>{{ txn.course_name }}</div>
        <div>{{ txn.type }}</div>
        <div>{{ txn.amount }} BDT</div>
        <div
          [class.completed]="txn.status === 'Completed'"
          [class.pending]="txn.status === 'Pending'"
        >
          {{ txn.status }}
        </div>
      </div>
    </div>
  </div>
</div>
